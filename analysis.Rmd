---
title: "Analysis"
---


<<<<<<< HEAD
```{r,echo=FALSE,message = FALSE, warning = FALSE}

batting<-read.csv("../EDA_Data/Batting.csv",header=TRUE)
pitching<-read.csv("../EDA_Data/Pitching.csv",header=TRUE)
salaries<-read.csv("../EDA_Data/Salaries.csv",header=TRUE)

library(tidyverse)
library(dplyr)
library(ggplot2)


```

```{r,echo=FALSE,message = FALSE, warning = FALSE}
batting2 = filter(batting, batting$yearID > 1985) %>% select(yearID,H,X2B,X3B,HR,AB,BB,HBP,SF,) %>% na.omit() %>% mutate(TB = H+2*X2B+(3*X3B)+(4*HR)) %>% mutate(SLG = TB/AB) %>% na.omit() %>% mutate(OBP = (H + BB + HBP)/(AB + BB + SF + HBP)) %>% mutate(OPS = SLG + OBP)

table = batting2 %>% group_by(yearID) %>% summarise(avgOPS = mean(OPS))
```

<<<<<<< HEAD
```{r,echo=FALSE}
ggplot(table, aes(x =yearID, y = avgOPS)) + geom_point() + geom_smooth(se=FALSE) + ggtitle("Average OPS Over Time")

```

We can see that average OPS increases during the 90's and then decreases. 

```{r,echo=FALSE,message = FALSE, warning = FALSE}
pitching2 = filter(pitching, pitching$yearID > 1985) %>% select(yearID,ERA) %>% na.omit
table2 = pitching2 %>% group_by(yearID) %>% summarise(avgERA = mean(ERA))
ggplot(table2, aes(x =yearID, y = avgERA)) + geom_point() + geom_smooth(se=FALSE) + ggtitle("Average ERA Over Time")
```

We can see that average ERA increaes until 2000 and the decreases.

The lower the ERA, the better the pitcher is considered. 
The higher the OPS, the better the batter is considered.

We can see ERA increase when OPS did, and then both begin to decrease around the end of the steriod era.

It appears that steriods did give an advantage to batters over pithers during the steriod era.

```{r,echo=FALSE,message = FALSE, warning = FALSE}
batsal = left_join(batting,salaries, by="playerID")
batsal2 = filter(batsal, batsal$yearID.x > 1985) %>% select(yearID.x,H,X2B,X3B,HR,AB,BB,HBP,SF,salary,teamID.x) %>% na.omit() %>% mutate(TB = H+2*X2B+(3*X3B)+(4*HR)) %>% mutate(SLG = TB/AB) %>% na.omit() %>% mutate(OBP = (H + BB + HBP)/(AB + BB + SF + HBP)) %>% mutate(OPS = SLG + OBP)

table4 = batsal2 %>% group_by(yearID.x) %>% summarise(avgOPS = mean(OPS), meansalprop=mean(salary)/10000000)

ggplot() + geom_smooth(data=table4, aes(x=yearID.x,y=avgOPS),se=FALSE) + geom_smooth(data=table4, aes(x=yearID.x,y=meansalprop),se=FALSE)

```

The bottom line shows that salaries were increasing quicker when OPS was increasing.


```{r, include=FALSE}
#str(master_file)
#Things to consider for for RQ's: strikeouts and era for pitchers pre, during and post(steriod use).....also obp and batting average for hitters pre, during and post.
#Steriod use staring around late 80's and dying out in 2003, yet continuing to see suspensions to this day for steriods.
```




